<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Smooth Snake Game</title>

<style>
    body {
        background: #111;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
        color: #fff;
        font-family: Arial;
        flex-direction: column;
    }
    canvas {
        background: #000;
        border: 4px solid white;
    }
</style>
</head>

<body>

<h1>Smooth Snake Game</h1>
<canvas id="game" width="450" height="450"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

const gridSize = 15;
const tile = canvas.width / gridSize;

let snake = [{ x: 7, y: 7 }];
let food = spawnFood();

let dx = 0, dy = 0;
let gameOver = false;

// ---------------------------
// GAME LOOP
// ---------------------------
function loop() {
    if (gameOver) return;

    setTimeout(() => {
        update();
        draw();
        loop();
    }, 130);
}

document.addEventListener("keydown", changeDirection);

// ---------------------------
// GAME UPDATE
// ---------------------------
function update() {
    if (dx === 0 && dy === 0) return;

    const head = {
        x: snake[0].x + dx,
        y: snake[0].y + dy
    };

    // WALL COLLISION
    if (head.x < 0 || head.x >= gridSize || head.y < 0 || head.y >= gridSize) {
        return endGame();
    }

    // SELF COLLISION
    if (snake.some(p => p.x === head.x && p.y === head.y)) {
        return endGame();
    }

    snake.unshift(head);

    if (head.x === food.x && head.y === food.y) {
        food = spawnFood();
    } else {
        snake.pop();
    }
}

// ---------------------------
// DRAW EVERYTHING
// ---------------------------
function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    drawFood();
    drawSnake();
}

// ---------------------------
// DRAW SNAKE (ONE PIECE BODY)
// ---------------------------
function drawSnake() {
    ctx.fillStyle = "limegreen";

    ctx.beginPath();
    ctx.moveTo(snake[0].x * tile + tile/2, snake[0].y * tile + tile/2);

    for (let i = 1; i < snake.length; i++) {
        ctx.lineTo(snake[i].x * tile + tile/2, snake[i].y * tile + tile/2);
    }

    ctx.lineWidth = tile - 4;
    ctx.lineCap = "round";
    ctx.strokeStyle = "limegreen";
    ctx.stroke();

    drawHeadFace();
}

// ---------------------------
// HEAD FACE (CARTOON EYES + MOUTH)
// ---------------------------
function drawHeadFace() {
    const head = snake[0];
    const cx = head.x * tile + tile / 2;
    const cy = head.y * tile + tile / 2;
    const r = (tile / 2) - 2;

    // Draw head circle
    ctx.fillStyle = "limegreen";
    ctx.beginPath();
    ctx.arc(cx, cy, r, 0, Math.PI * 2);
    ctx.fill();

    // Eyes
    ctx.fillStyle = "white";
    ctx.beginPath();
    ctx.arc(cx - 5, cy - 5, 3, 0, Math.PI * 2);
    ctx.arc(cx + 5, cy - 5, 3, 0, Math.PI * 2);
    ctx.fill();

    // Pupils
    ctx.fillStyle = "black";
    ctx.beginPath();
    ctx.arc(cx - 5, cy - 5, 1.5, 0, Math.PI * 2);
    ctx.arc(cx + 5, cy - 5, 1.5, 0, Math.PI * 2);
    ctx.fill();

    // Mouth
    ctx.strokeStyle = "black";
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.arc(cx, cy + 2, 5, 0, Math.PI);
    ctx.stroke();
}

// ---------------------------
// FOOD
// ---------------------------
function drawFood() {
    ctx.fillStyle = "red";
    ctx.beginPath();
    ctx.arc(food.x * tile + tile/2, food.y * tile + tile/2, tile/3, 0, Math.PI * 2);
    ctx.fill();
}

function spawnFood() {
    return {
        x: Math.floor(Math.random() * gridSize),
        y: Math.floor(Math.random() * gridSize)
    };
}

// ---------------------------
// INPUT
// ---------------------------
function changeDirection(e) {
    if (gameOver) return;

    if (e.key === "ArrowUp" && dy !== 1) {
        dx = 0; dy = -1;
    } else if (e.key === "ArrowDown" && dy !== -1) {
        dx = 0; dy = 1;
    } else if (e.key === "ArrowLeft" && dx !== 1) {
        dx = -1; dy = 0;
    } else if (e.key === "ArrowRight" && dx !== -1) {
        dx = 1; dy = 0;
    }
}

// ---------------------------
// END GAME
// ---------------------------
function endGame() {
    gameOver = true;

    setTimeout(() => {
        alert("Game Over! Refresh to play again.");
    }, 10);
}

// START
loop();
</script>

</body>
</html>
